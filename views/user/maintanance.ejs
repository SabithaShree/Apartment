<script>
$(document).ready(function() {
  let payment = new Payment();
  payment.registerEvents("#maintanance-container");
});
</script>
  
<div id="maintanance-container" class="maintanance-container container-fluid">

<form id="payment-form" class="form-horizontal payment-form" method="POST">
  <h4 class="payment-form-heading">Maintanance Payment Form</h4>
  <div class="form-group row">
    <label class="control-label col-sm-4" for="paymentInfo">Month & Year</label>
    <div class="col-sm-8">
      <div class="btn-group maintanance-dd">
        <button type="button" class="btn btn-light dropdown-toggle" id="month" data-toggle="dropdown">Month</button>
        <div class="dropdown-menu maintanance-month" aria-labelledby="month">
          <a class="dropdown-item" href="#">January</a>
          <a class="dropdown-item" href="#">February</a>
          <a class="dropdown-item" href="#">March</a>
          <a class="dropdown-item" href="#">April</a>
          <a class="dropdown-item" href="#">May</a>
          <a class="dropdown-item" href="#">June</a>
          <a class="dropdown-item" href="#">July</a>
          <a class="dropdown-item" href="#">August</a>
          <a class="dropdown-item" href="#">September</a>
          <a class="dropdown-item" href="#">October</a>
          <a class="dropdown-item" href="#">November</a>
          <a class="dropdown-item" href="#">December</a>
        </div>
      </div>
      <div class="btn-group maintanance-dd">
        <button type="button" class="btn btn-light dropdown-toggle" id="year" data-toggle="dropdown">Year</button>
        <div class="dropdown-menu maintanance-year" aria-labelledby="year">
          <a class="dropdown-item" href="#">2020</a>
          <a class="dropdown-item" href="#">2021</a>
          <a class="dropdown-item" href="#">2022</a>
          <a class="dropdown-item" href="#">2023</a>
          <a class="dropdown-item" href="#">2024</a>
        </div>
      </div>
    </div>
  </div>
  <div class="form-group row mt-5">
    <label class="control-label col-sm-4" for="amount">Maintanance</label>
    <div class="col-sm-8">
      <input name="amount" type="text" class="form-control amount-input" id="amount" placeholder="Maintanance Amount">
    </div>
  </div>
  <div class="form-group text-center mt-5">
      <button class="btn btn-primary" type="submit">Pay</button>
  </div>
</form>

<%
    let tableHeadings = ["txn_id", "date", "amount", "period", "status"];

    function getDateStr(date)
    {
       const months = [
            "January", "February", "March", "April", "May", "June", "July",
            "August", "September", "October", "November", "December"];

        const dateStr = months[date.getMonth()] + " " + date.getDate()+ ", " + date.getFullYear();
        return dateStr;
    }

    function getTimeStr(date)
    {
       const timeStr = date.toLocaleString("en-US", { hour: "numeric", minute: "numeric", hour12: true });
       return timeStr;
    }
  %>

<div id="payments-container" class="payments-container">
  <table class="table payments-table center">
    <thead class="table-head">
      <tr>
        <th scope="col">TransactionId</th>
        <th scope="col">Date</th>
        <th scope="col">Amount</th>
        <th scope="col">Period</th>
        <th scope="col">Status</th>
      </tr>
    </thead>
    <tbody>

      <%
        if(payments.length > 0) {
          payments.forEach((payment) => { %>
          <tr>
          <% for(var i=0; i<tableHeadings.length; i++) { %>
              <% if(tableHeadings[i] === "date")  {%>
                <td><%= getDateStr(payment[tableHeadings[i]]) %></td>
              <% } else if(tableHeadings[i] === "amount")  { %>
                  <td>Rs.<%= payment[tableHeadings[i]] %></td>
              <% } else { %>
                <td><%= payment[tableHeadings[i]] %></td>
            <% } } %>
          </tr>
        <% }); 
          } 
          else { %>
            <td colspan="5">
              <div class="no-transactions">
                <img src="/images/no-transactions.png" alt="no-transactions">
              </div>
              Your maintanance history will appear hear.
            </td>
          <% } %>
    </tbody>
  </table>
</div>

</div>

<%- include("../partials/loading") -%>
